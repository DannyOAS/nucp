{% extends "base.html" %}

{% block title %}Prescription Request - Northern Health Innovations{% endblock %}

{% block content %}
<div class="container mx-auto px-6 py-12">

    <!-- Prescription Header -->
    <h1 class="text-4xl font-extrabold text-[#004d40] text-center">Prescription Request</h1>
    <p class="mt-4 text-lg text-gray-700 text-center max-w-3xl mx-auto">
        Please complete this form to request a prescription. Ensure all information is accurate and up-to-date.
    </p>

    <div class="mt-12 max-w-3xl mx-auto bg-gray-100 shadow-md rounded-2xl p-8">

        <!-- Success Message -->
        {% if messages %}
            <div class="mb-6 flex justify-center">
                {% for message in messages %}
                    <div id="success-message" class="relative w-full max-w-3xl px-6 py-3 rounded-lg shadow-md text-center font-semibold"
                         style="background-color: #004d40; color: white; border: 1px solid #00332e; transition: opacity 0.5s ease-in-out;">
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <!-- Prescription Form -->
        <form method="POST" class="space-y-4">
            {% csrf_token %}

            <!-- Patient Information Section -->
            <div class="space-y-4">
                <h2 class="text-xl font-bold text-[#004d40]">Patient Information</h2>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">First Name:</label>
                    {{ form.first_name }}
                </div>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">Last Name:</label>
                    {{ form.last_name }}
                </div>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">Date of Birth:</label>
                    {{ form.date_of_birth }}
                </div>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">OHIP Number:</label>
                    {{ form.ohip_number }}
                </div>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">Phone Number:</label>
                    {{ form.phone_number }}
                </div>
            </div>

            <!-- Prescription Details Section -->
            <div class="space-y-4 mt-8">
                <h2 class="text-xl font-bold text-[#004d40]">Prescription Details</h2>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">Medication Name:</label>
                    {{ form.medication_name }}
                </div>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">Current Dosage:</label>
                    {{ form.current_dosage }}
                </div>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">How long have you been taking this medication?</label>
                    {{ form.medication_duration }}
                </div>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">Last Refill Date:</label>
                    {{ form.last_refill_date }}
                </div>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">Preferred Pharmacy:</label>
                    {{ form.preferred_pharmacy }}
                </div>
            </div>

            <!-- Medical History Section -->
            <div class="space-y-4 mt-8">
                <h2 class="text-xl font-bold text-[#004d40]">Medical Information</h2>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">Any new medical conditions since last visit?</label>
                    {{ form.new_medical_conditions }}
                </div>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">Any new medications since last visit?</label>
                    {{ form.new_medications }}
                </div>

                <div class="space-y-2">
                    <label class="block text-gray-700 font-semibold">Any side effects or concerns?</label>
                    {{ form.side_effects }}
                </div>
            </div>

            <!-- Consent Section -->
            <div class="space-y-4 mt-8">
                <h2 class="text-xl font-bold text-[#004d40]">Consent</h2>

                <div class="flex items-center space-x-2">
                    {{ form.information_consent }}
                    <label class="text-gray-700">I confirm that all provided information is accurate and complete</label>
                </div>

                <div class="flex items-center space-x-2">
                    {{ form.pharmacy_consent }}
                    <label class="text-gray-700">I authorize the pharmacy to receive and process this prescription request</label>
                </div>
            </div>

            <button type="submit"
                    class="w-full bg-[#004d40] text-white font-bold py-3 rounded-lg hover:bg-[#00332e] transition-all duration-200">
                Submit Prescription Request
            </button>
        </form>
    </div>
</div>

<!-- Auto-hide Success Message after 5 seconds -->
<script>
    setTimeout(function() {
        let successMessage = document.getElementById('success-message');
        if (successMessage) {
            successMessage.style.opacity = '0';
            setTimeout(() => successMessage.style.display = 'none', 500);
        }
    }, 5000);
</script>

{% endblock %}
